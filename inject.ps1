$payload = 'IyBBdXRvLWVsZXZhdGlvbiBmdW5jdGlvbjogUmVsYXVuY2ggc2NyaXB0IGFzIGFkbWluIGlmIG5vdCBlbGV2YXRlZA0KZnVuY3Rpb24gRW5zdXJlLVJ1bkFzQWRtaW4gew0KICAgICRjdXJyZW50VXNlciA9IFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpDQogICAgJHByaW5jaXBhbCA9IE5ldy1PYmplY3QgU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NQcmluY2lwYWwoJGN1cnJlbnRVc2VyKQ0KICAgICRpc0FkbWluID0gJHByaW5jaXBhbC5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdGluUm9sZV06OkFkbWluaXN0cmF0b3IpDQogICAgaWYgKC1ub3QgJGlzQWRtaW4pIHsNCiAgICAgICAgJHBzaSA9IE5ldy1PYmplY3QgU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3NTdGFydEluZm8NCiAgICAgICAgJHBzaS5GaWxlTmFtZSA9ICJwb3dlcnNoZWxsLmV4ZSINCiAgICAgICAgJHBzaS5Bcmd1bWVudHMgPSAiLU5vUHJvZmlsZSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtV2luZG93U3R5bGUgSGlkZGVuIC1GaWxlIGAiJFBTQ29tbWFuZFBhdGhgIiINCiAgICAgICAgJHBzaS5WZXJiID0gInJ1bmFzIg0KICAgICAgICAkcHNpLlVzZVNoZWxsRXhlY3V0ZSA9ICR0cnVlDQogICAgICAgICRwc2kuV2luZG93U3R5bGUgPSAnSGlkZGVuJw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgW1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzXTo6U3RhcnQoJHBzaSkgfCBPdXQtTnVsbA0KICAgICAgICB9IGNhdGNoIHsNCiAgICAgICAgICAgIFdyaXRlLUVycm9yICJVc2VyIGNhbmNlbGxlZCB0aGUgZWxldmF0aW9uIHByb21wdC4iDQogICAgICAgIH0NCiAgICAgICAgZXhpdA0KICAgIH0NCn0NCg0KRW5zdXJlLVJ1bkFzQWRtaW4NCg0KIyAtLS0tIFsgU3RhcnQgaW1ndWkuaW5pIE1vbml0b3IgTG9vcCBhcyBhIGJhY2tncm91bmQgam9iIF0gLS0tLQ0KU3RhcnQtSm9iIC1TY3JpcHRCbG9jayB7DQogICAgJGRlc2t0b3BQYXRoID0gW0Vudmlyb25tZW50XTo6R2V0Rm9sZGVyUGF0aCgnRGVza3RvcCcpDQogICAgJGluaVBhdGggPSBKb2luLVBhdGggJGRlc2t0b3BQYXRoICJpbWd1aS5pbmkiDQogICAgd2hpbGUgKCR0cnVlKSB7DQogICAgICAgIGlmIChUZXN0LVBhdGggJGluaVBhdGgpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgUmVtb3ZlLUl0ZW0gJGluaVBhdGggLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlDQogICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJEZWxldGVkIGltZ3VpLmluaSBhdCAkKEdldC1EYXRlIC1Gb3JtYXQgJ0hIOm1tOnNzJykiDQogICAgICAgICAgICB9IGNhdGNoIHt9DQogICAgICAgIH0NCiAgICAgICAgU3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyA1MA0KICAgIH0NCn0gfCBPdXQtTnVsbA0KDQojIC0tLS0gWyBETEwgSW5qZWN0aW9uIFNlY3Rpb24gXSAtLS0tDQokZGxsRm9sZGVyID0gIkM6XFdpbmRvd3NcU3lzV09XNjQiDQokZGxsMSA9ICJBb3Ric3QuZGxsIg0KJGRsbDIgPSAiY2ltZ3VpLmRsbCINCiRkbGwzID0gImR3bWhvc3QuZGxsIg0KJHByb2Nlc3NOYW1lID0gIkhELVBsYXllciINCiRzeXN0ZW0zMlBhdGggPSAiJGVudjp3aW5kaXJcU3lzdGVtMzIiDQokc3lzd293NjRQYXRoID0gIiRlbnY6d2luZGlyXFN5c1dPVzY0Ig0KDQojIC0tLS0gWyBDb3B5IGR3bWhvc3QuZGxsIGZyb20gU3lzdGVtMzIgdG8gU3lzV09XNjQgXSAtLS0tDQokc291cmNlRGxsM1BhdGggPSBKb2luLVBhdGggLVBhdGggJHN5c3RlbTMyUGF0aCAtQ2hpbGRQYXRoICRkbGwzDQokZGVzdERsbDNQYXRoID0gSm9pbi1QYXRoIC1QYXRoICRzeXN3b3c2NFBhdGggLUNoaWxkUGF0aCAkZGxsMw0KDQppZiAoVGVzdC1QYXRoICRzb3VyY2VEbGwzUGF0aCkgew0KICAgIHRyeSB7DQogICAgICAgIENvcHktSXRlbSAtUGF0aCAkc291cmNlRGxsM1BhdGggLURlc3RpbmF0aW9uICRkZXN0RGxsM1BhdGggLUZvcmNlDQogICAgICAgIFdyaXRlLU91dHB1dCAiQ29waWVkICRkbGwzIGZyb20gU3lzdGVtMzIgdG8gU3lzV09XNjQgc3VjY2Vzc2Z1bGx5LiINCiAgICB9IGNhdGNoIHsNCiAgICAgICAgV3JpdGUtRXJyb3IgIkZhaWxlZCB0byBjb3B5ICRkbGwzIHRvIFN5c1dPVzY0OiAkXyINCiAgICB9DQp9IGVsc2Ugew0KICAgIFdyaXRlLUVycm9yICJTb3VyY2UgJGRsbDMgbm90IGZvdW5kIGluIFN5c3RlbTMyLiINCn0NCg0KJGluamVjdG9yQ29kZSA9IEAiDQp1c2luZyBTeXN0ZW07DQp1c2luZyBTeXN0ZW0uVGV4dDsNCnVzaW5nIFN5c3RlbS5EaWFnbm9zdGljczsNCnVzaW5nIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlczsNCg0KcHVibGljIGNsYXNzIEluamVjdG9yDQp7DQogICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIildDQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIE9wZW5Qcm9jZXNzKGludCBkd0Rlc2lyZWRBY2Nlc3MsIGJvb2wgYkluaGVyaXRIYW5kbGUsIGludCBkd1Byb2Nlc3NJZCk7DQoNCiAgICBbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiKV0NCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgVmlydHVhbEFsbG9jRXgoSW50UHRyIGhQcm9jZXNzLCBJbnRQdHIgbHBBZGRyZXNzLCB1aW50IGR3U2l6ZSwgdWludCBmbEFsbG9jYXRpb25UeXBlLCB1aW50IGZsUHJvdGVjdCk7DQoNCiAgICBbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiKV0NCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIFdyaXRlUHJvY2Vzc01lbW9yeShJbnRQdHIgaFByb2Nlc3MsIEludFB0ciBscEJhc2VBZGRyZXNzLCBieXRlW10gYnVmZmVyLCB1aW50IHNpemUsIG91dCBVSW50UHRyIHdyaXR0ZW4pOw0KDQogICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIildDQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldFByb2NBZGRyZXNzKEludFB0ciBoTW9kdWxlLCBzdHJpbmcgcHJvY05hbWUpOw0KDQogICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIildDQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldE1vZHVsZUhhbmRsZShzdHJpbmcgbHBNb2R1bGVOYW1lKTsNCg0KICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIpXQ0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBDcmVhdGVSZW1vdGVUaHJlYWQoSW50UHRyIGhQcm9jZXNzLCBJbnRQdHIgbHBUaHJlYWRBdHRyaWJ1dGVzLA0KICAgICAgICB1aW50IGR3U3RhY2tTaXplLCBJbnRQdHIgbHBTdGFydEFkZHJlc3MsIEludFB0ciBscFBhcmFtZXRlciwgdWludCBkd0NyZWF0aW9uRmxhZ3MsIEludFB0ciBscFRocmVhZElkKTsNCg0KICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIpXQ0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgQ2xvc2VIYW5kbGUoSW50UHRyIGhPYmplY3QpOw0KDQogICAgcHVibGljIGNvbnN0IGludCBQUk9DRVNTX0NSRUFURV9USFJFQUQgPSAweDAwMDI7DQogICAgcHVibGljIGNvbnN0IGludCBQUk9DRVNTX1FVRVJZX0lORk9STUFUSU9OID0gMHgwNDAwOw0KICAgIHB1YmxpYyBjb25zdCBpbnQgUFJPQ0VTU19WTV9PUEVSQVRJT04gPSAweDAwMDg7DQogICAgcHVibGljIGNvbnN0IGludCBQUk9DRVNTX1ZNX1dSSVRFID0gMHgwMDIwOw0KICAgIHB1YmxpYyBjb25zdCBpbnQgUFJPQ0VTU19WTV9SRUFEID0gMHgwMDEwOw0KDQogICAgcHVibGljIGNvbnN0IHVpbnQgTUVNX0NPTU1JVCA9IDB4MDAwMDEwMDA7DQogICAgcHVibGljIGNvbnN0IHVpbnQgTUVNX1JFU0VSVkUgPSAweDAwMDAyMDAwOw0KICAgIHB1YmxpYyBjb25zdCB1aW50IFBBR0VfUkVBRFdSSVRFID0gMHgwNDsNCg0KICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBJbmplY3QoaW50IHBpZCwgc3RyaW5nIGRsbFBhdGgpDQogICAgew0KICAgICAgICBJbnRQdHIgaFByb2Nlc3MgPSBPcGVuUHJvY2VzcyhQUk9DRVNTX0NSRUFURV9USFJFQUQgfCBQUk9DRVNTX1FVRVJZX0lORk9STUFUSU9OIHwgUFJPQ0VTU19WTV9PUEVSQVRJT04gfCBQUk9DRVNTX1ZNX1dSSVRFIHwgUFJPQ0VTU19WTV9SRUFELCBmYWxzZSwgcGlkKTsNCiAgICAgICAgaWYgKGhQcm9jZXNzID09IEludFB0ci5aZXJvKQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KDQogICAgICAgIEludFB0ciBhbGxvY01lbUFkZHJlc3MgPSBWaXJ0dWFsQWxsb2NFeChoUHJvY2VzcywgSW50UHRyLlplcm8sICh1aW50KSgoZGxsUGF0aC5MZW5ndGggKyAxKSAqIE1hcnNoYWwuU2l6ZU9mKHR5cGVvZihjaGFyKSkpLA0KICAgICAgICAgICAgTUVNX0NPTU1JVCB8IE1FTV9SRVNFUlZFLCBQQUdFX1JFQURXUklURSk7DQogICAgICAgIGlmIChhbGxvY01lbUFkZHJlc3MgPT0gSW50UHRyLlplcm8pDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgYnl0ZVtdIGJ5dGVzID0gRW5jb2RpbmcuVW5pY29kZS5HZXRCeXRlcyhkbGxQYXRoKTsNCiAgICAgICAgVUludFB0ciBieXRlc1dyaXR0ZW47DQogICAgICAgIGJvb2wgcmVzdWx0ID0gV3JpdGVQcm9jZXNzTWVtb3J5KGhQcm9jZXNzLCBhbGxvY01lbUFkZHJlc3MsIGJ5dGVzLCAodWludClieXRlcy5MZW5ndGgsIG91dCBieXRlc1dyaXR0ZW4pOw0KICAgICAgICBpZiAoIXJlc3VsdCB8fCBieXRlc1dyaXR0ZW4uVG9VSW50MzIoKSAhPSBieXRlcy5MZW5ndGgpDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgSW50UHRyIGtlcm5lbDMySGFuZGxlID0gR2V0TW9kdWxlSGFuZGxlKCJrZXJuZWwzMi5kbGwiKTsNCiAgICAgICAgSW50UHRyIGxvYWRMaWJyYXJ5QWRkciA9IEdldFByb2NBZGRyZXNzKGtlcm5lbDMySGFuZGxlLCAiTG9hZExpYnJhcnlXIik7DQoNCiAgICAgICAgaWYgKGxvYWRMaWJyYXJ5QWRkciA9PSBJbnRQdHIuWmVybykNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCg0KICAgICAgICBJbnRQdHIgcmVtb3RlVGhyZWFkID0gQ3JlYXRlUmVtb3RlVGhyZWFkKGhQcm9jZXNzLCBJbnRQdHIuWmVybywgMCwgbG9hZExpYnJhcnlBZGRyLCBhbGxvY01lbUFkZHJlc3MsIDAsIEludFB0ci5aZXJvKTsNCiAgICAgICAgaWYgKHJlbW90ZVRocmVhZCA9PSBJbnRQdHIuWmVybykNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCg0KICAgICAgICBDbG9zZUhhbmRsZShoUHJvY2Vzcyk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCn0NCg0KcHVibGljIGNsYXNzIEtleUNoZWNrDQp7DQogICAgW0RsbEltcG9ydCgidXNlcjMyLmRsbCIpXQ0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIHNob3J0IEdldEFzeW5jS2V5U3RhdGUoaW50IHZLZXkpOw0KDQogICAgcHVibGljIHN0YXRpYyBib29sIElzRGVsUHJlc3NlZCgpDQogICAgew0KICAgICAgICByZXR1cm4gKEdldEFzeW5jS2V5U3RhdGUoMHgyRSkgJiAweDgwMDApICE9IDA7DQogICAgfQ0KfQ0KIkANCg0KQWRkLVR5cGUgLVR5cGVEZWZpbml0aW9uICRpbmplY3RvckNvZGUgLUxhbmd1YWdlIENTaGFycA0KDQpXcml0ZS1PdXRwdXQgIk1vbml0b3JpbmcgZm9yIHByb2Nlc3MgJHByb2Nlc3NOYW1lLi4uIg0KDQp3aGlsZSAoJHRydWUpIHsNCiAgICAkcHJvYyA9IEdldC1Qcm9jZXNzIC1OYW1lICRwcm9jZXNzTmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQ0KICAgIGlmICgkcHJvYykgew0KICAgICAgICBXcml0ZS1PdXRwdXQgIlByb2Nlc3MgJHByb2Nlc3NOYW1lIGZvdW5kIHdpdGggUElEICQoJHByb2MuSWQpIg0KICAgICAgICBXcml0ZS1PdXRwdXQgIldhaXRpbmcgZm9yIFtEZWxdIGtleSB0byBpbmplY3QgRExMcy4uLiINCg0KICAgICAgICB3aGlsZSAoLW5vdCBbS2V5Q2hlY2tdOjpJc0RlbFByZXNzZWQoKSkgew0KICAgICAgICAgICAgU3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyA1MA0KICAgICAgICB9DQoNCiAgICAgICAgV3JpdGUtT3V0cHV0ICJbRGVsXSBwcmVzc2VkLiBQcm9jZWVkaW5nIHdpdGggRExMIGluamVjdGlvbi4uLiINCg0KICAgICAgICAkZGxsMVBhdGggPSBKb2luLVBhdGggJGRsbEZvbGRlciAkZGxsMQ0KICAgICAgICAkZGxsMlBhdGggPSBKb2luLVBhdGggJGRsbEZvbGRlciAkZGxsMg0KDQogICAgICAgIGZvcmVhY2ggKCRkbGwgaW4gQCgkZGxsMVBhdGgsICRkbGwyUGF0aCkpIHsNCiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiSW5qZWN0aW5nICRkbGwgaW50byBwcm9jZXNzICRwcm9jZXNzTmFtZSAoUElEOiAkKCRwcm9jLklkKSkuLi4iDQogICAgICAgICAgICAkc3VjY2VzcyA9IFtJbmplY3Rvcl06OkluamVjdCgkcHJvYy5JZCwgJGRsbCkNCiAgICAgICAgICAgIGlmICgkc3VjY2Vzcykgew0KICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiU3VjY2Vzc2Z1bGx5IGluamVjdGVkICRkbGwiDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIFdyaXRlLUVycm9yICJGYWlsZWQgdG8gaW5qZWN0ICRkbGwiDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBkbyB7DQogICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAyDQogICAgICAgICAgICAkcHJvYyA9IEdldC1Qcm9jZXNzIC1JZCAkcHJvYy5JZCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQ0KICAgICAgICB9IHdoaWxlICgkcHJvYykNCg0KICAgICAgICBXcml0ZS1PdXRwdXQgIiRwcm9jZXNzTmFtZSBleGl0ZWQuIFJlc3VtaW5nIG1vbml0b3JpbmcuLi4iDQogICAgfSBlbHNlIHsNCiAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgMg0KICAgIH0NCn0=';
$decoded = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($payload));
Invoke-Expression $decoded;
